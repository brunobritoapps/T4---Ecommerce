<script type="text/javascript">    var remote = new Remote('php/comunicacao.php', 'acesso', 'usuario_permissao');    var oTable;    var defTable;    function resultGetUsuario(dados) {        renderizaTabelaDefault(dados);    }    function resultGetContas(dados) {        $("#sel_contas").html("");        for (var i = 0; i < dados.length; i++) {            $("#sel_contas").append('<option value="' + dados[i].id + '">' + dados[i].nome + '</option>');        }        $("#sel_contas").selectpicker("refresh");    }    function renderizaTabelaDefault(dados) {        if (oTable == null) {            defTable = $('#t_dados').html();        } else {            $('#t_dados').html(defTable);        }        var objDataTable = colunasDefaultDataTable($('#t_dados'), dados);        oTable = $('#t_dados').dataTable(objDataTable);        $("#t_dados ").find('td:nth-child(7)').hide();        $("#t_dados ").find('th:nth-child(7)').hide();        $(window).resize();    }    function resultUploadFoto(dados){        var rnd = Math.random()        $("#divImgUser").html('<div class="profile"><div class="profile-image"><img src="php/outros/loadimage.php?n='+dados+'&c='+rnd+'" class="foto_usuario" alt="Usu�rio"></div></div>');    }    function validSetUsuario(){        var usuario = $('#txtUser').val();        var senha = $('#txtSenha').val();        var nome = $('#txtNome').val();        var sobrenome = $('#txtSobrenome').val();        var email = $('#txtEmail').val();        var cpf = $('#txtCpf').val();        var contas = $('#sel_contas').find(":selected").val();        var status = $('#sel_status').find(":selected").val();        var valid_usuario = true;        if(usuario==''){            valid_usuario = false;            noty({                text: '<br/><b><p><span class="fa fa-exclamation-circle"></span><font size="2">   Faltam informações no cadastro de usuário</font></p></b><p>Campo (Usuário)</p>',                type: 'warning',                layout: 'topCenter',                timeout: 4000            });        }        var valid_senha = true;        if(senha==''){            valid_senha = false;            noty({                text: '<br/><b><p><span class="fa fa-exclamation-circle"></span><font size="2">   Faltam informações no cadastro de usuário</font></p></b><p>Campo (Senha)</p>',                type: 'warning',                layout: 'topCenter',                timeout: 4000            });        }        var valid_nome = true;        if(nome==''){            valid_nome = false;            noty({                text: '<br/><b><p><span class="fa fa-exclamation-circle"></span><font size="2">   Faltam informações no cadastro de usuário</font></p></b><p>Campo (Nome)</p>',                type: 'warning',                layout: 'topCenter',                timeout: 4000            });        }        var valid_sobrenome = true;        if(sobrenome==''){            valid_sobrenome = false;            noty({                text: '<br/><b><p><span class="fa fa-exclamation-circle"></span><font size="2">   Faltam informações no cadastro de usuário</font></p></b><p>Campo (Sobrenome)</p>',                type: 'warning',                layout: 'topCenter',                timeout: 4000            });        }        var valid_email = true;        if(email==''){            valid_email = false;            noty({                text: '<br/><b><p><span class="fa fa-exclamation-circle"></span><font size="2">   Faltam informações no cadastro de usuário</font></p></b><p>Campo (Email)</p>',                type: 'warning',                layout: 'topCenter',                timeout: 4000            });        }        var valid_cpf = true;        if(cpf==''){            valid_cpf = false;            noty({                text: '<br/><b><p><span class="fa fa-exclamation-circle"></span><font size="2">   Faltam informações no cadastro de usuário</font></p></b><p>Campo (CPF)</p>',                type: 'warning',                layout: 'topCenter',                timeout: 4000            });        }        var valid_contas = true;        if(contas==0){            valid_contas = false;            noty({                text: '<br/><b><p><span class="fa fa-exclamation-circle"></span><font size="2">   Faltam informações no cadastro de usuário</font></p></b><p>Campo (Permissão)</p>',                type: 'warning',                layout: 'topCenter',                timeout: 4000            });        }        var valid_status = true;        if(status==0){            valid_status = false;            noty({                text: '<br/><b><p><span class="fa fa-exclamation-circle"></span><font size="2">   Faltam informações no cadastro de usuário</font></p></b><p>Campo (Status)</p>',                type: 'warning',                layout: 'topCenter',                timeout: 4000            });        }        if(valid_usuario==true & valid_senha==true & valid_nome==true & valid_sobrenome==true & valid_email==true & valid_email==true & valid_cpf==true & valid_contas==true & valid_status==true){            return true        }else {            return false        }    }    function validInput(dom,tipo){        switch(tipo){            case'num':var regex=/[A-Za-z]/g;break;            case'text':var regex=/\d/g;break;        }        dom.value=dom.value.replace(regex,'');        dom.value=dom.value.replace(',','');        dom.value=dom.value.replace('.','');        dom.value=dom.value.replace('-','');    }    $(document).ready(function () {        remote.executa("getUsuario", null, resultGetUsuario, $('#pnlUsuario'), erroPersonalizado);        remote.executa("getContas", null, resultGetContas, $('#divEdicao'), erroPersonalizado);        //script de upload        var uploader = new plupload.Uploader({            runtimes: 'gears,html5,flash,silverlight,browserplus',            browse_button: 'pickfiles',            drop_element: 'pickfiles',            container: 'container',            chunk_size: '5mb',            max_file_size: '200mb',            url: 'upload.php',            multi_selection: false,            unique_names: true,            flash_swf_url: 'theme/js/plugins/plupload/js/plupload.flash.swf',            silverlight_xap_url: 'theme/js/plugins/plupload/js/plupload.flash.swf',            filters: [                {title: "Imagem jpg", extensions: "jpg"}            ]        });        uploader.bind('Init', function (up, params) {            $('#filelist').html("");        });        $('#uploadfiles').click(function (e) {            uploader.start();            $("#uploadfiles").hide();            e.preventDefault();        });        uploader.init();        uploader.bind('FilesAdded', function (up, files) {            $.each(files, function (i, file) {                $('#filelist').html('<span> ' + file.name + ' (' + plupload.formatSize(file.size) + ') <span id="' + file.id + '"></span>');            });            $("#uploadfiles").show();            up.refresh(); // Reposition Flash/Silverlight        });        uploader.bind('UploadProgress', function (up, file) {            $('#filelist').html('<div class="progress-list"><div class="pull-left"><strong class="text-success">Progresso:</strong></div><div class="pull-right">' + plupload.formatSize(file.loaded) + 'MB/' + plupload.formatSize(file.size) + 'MB (' + file.percent + '%)</div><div class="progress progress-small progress-striped active"><div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="' + file.percent + '" aria-valuemin="0" aria-valuemax="100" style="width: ' + file.percent + '%;">' + file.percent + '%</div></div></div>');        });        uploader.bind('Error', function (up, err) {            $('#filelist').html("Error: " + err.code +                ", Message: " + err.message +                (err.file ? ", File: " + err.file.name : "")            );            up.refresh(); // Reposition Flash/Silverlight        });        uploader.bind('FileUploaded', function (up, file, info) {            $('#filelist').html('<span> ' + file.name + ' (' + plupload.formatSize(file.size) + ') </span><span class="fa fa-check" style="color: #95b75d"></span>');            var obj = JSON.parse(info.response);            arquivo = obj.cleanFileName;            remote.executa("uploadFoto", {"arquivo": obj.cleanFileName, id: $("#txtId").val()}, resultUploadFoto, $('#divResul .panel'));        });        $("#btnAdd").on('click', function () {            $("#lblTitulo").html("Adicionando...");            $("#txtId").val("");            $("#txtUser").val("");            $("#txtNome").val("");            $("#txtSobrenome").val("");            $("#txtCpf").val("");            $("#txtSenha").val("");            $("#txtEmail").val("");            $("#sel_status").val("");            $("#sel_status").selectpicker("refresh");            $("#sel_contas").selectpicker("refresh");            exibeDivPadrao(true);        });        $("#btnEdt").on('click', function () {            var objTemp = oTable.fnGetData(oTable.closest("table").find(".selected"));            if (objTemp != null) {                $("#lblTitulo").html("Editando...");                $("#txtId").val(objTemp.id);                $("#txtUser").val(objTemp.usuario);                $("#txtNome").val(objTemp.nome);                $("#txtSobrenome").val(objTemp.sobrenome);                $("#txtCpf").val(objTemp.cpf);                $("#txtSenha").val(objTemp.senha);                $("#txtEmail").val(objTemp.email);                $("#sel_contas").val(objTemp.id_conta);                $("#sel_contas").selectpicker("refresh");                if(objTemp.status=="Ativo"){                    $("#sel_status").val(1);                    $("#sel_status").selectpicker("refresh");                }else{                    $("#sel_status").val(0);                    $("#sel_status").selectpicker("refresh");                }                $("#divImgUser").html('<div class="profile"><div class="profile-image"><img src="php/outros/loadimage.php?n='+objTemp.id+'" class="foto_usuario" alt="Usuário"></div></div>');                exibeDivPadrao(true);            }        });        $("#btnVol").on('click', function () {            exibeDivPadrao(false);        });        $("#btnGra").on('click', function () {            if(validSetUsuario()){                var param = {                    id: $("#txtId").val(),                    usuario: $("#txtUser").val(),                    nome: $("#txtNome").val(),                    sobrenome: $("#txtSobrenome").val(),                    email: $("#txtEmail").val(),                    cpf: $("#txtCpf").val(),                    senha: $("#txtSenha").val(),                    conta: $("#sel_contas").val(),                    status: $("#sel_status").val()                };                if((param.id == "" || param.id > 3) && param.conta == 1){                    erroPersonalizado("Não é possível setar esse nível de acesso para esse usuário!");                    return;                }else{                    remote.executa("setUsuario", param, function (dados) {                        exibeDivPadrao(false);                        resultGetUsuario(dados);                    }, $('.panel'), erroPersonalizado);                }            }        });        $("#btnRem").on('click', function () {            var objTemp = oTable.fnGetData(oTable.closest("table").find(".selected"));            if (objTemp != null) {                $("#txtId").val(objTemp.id);                $("#modal_small").modal();            }        });        $("#btnRemConf").on('click', function () {            remote.executa("remUsuario", {id: $("#txtId").val()}, resultGetUsuario, $('.panel'), erroPersonalizado);        });    });    function exibeDivPadrao(divPadrao) {        if (divPadrao == false) {            $("#divPadrao").show("fast");            $("#divEdicao").hide("fast");            $("#btnVol").hide();            $("#btnGra").hide();            $("#btnAdd").show();            $("#btnEdt").show();            $("#btnRem").show();            $("#divImgUser").html('');            $('#filelist').html('');        } else {            $("#divPadrao").hide("fast");            $("#divEdicao").show("fast");            $("#btnVol").show();            $("#btnGra").show();            $("#btnAdd").hide();            $("#btnEdt").hide();            $("#btnRem").hide();        }    }</script><!-- START BREADCRUMB --><ul class="breadcrumb"></ul><!-- END BREADCRUMB --><!-- PAGE CONTENT WRAPPER --><div class="page-content-wrap">    <div class="row">        <div class="col-md-8 col-md-offset-2">            <div id="pnlUsuario" class="panel panel-default">                <div class="panel-heading">                    <h3 class="panel-title">Usuários</h3>                    <ul class="panel-controls">                        <li><a href="#" id="btnAdd" class="control-info" data-acao="add" title="Adicionar"><span class="fa fa-plus"></span></a></li>                        <li><a href="#" id="btnEdt" class="control-warning" data-acao="edt" title="Editar"><span class="fa fa-pencil"></span></a></li>                        <li><a href="#" id="btnRem" class="control-danger" data-acao="rem" title="Excluir"><span class="fa fa-minus"></span></a></li>                        <li><a href="#" id="btnGra" class="control-success" data-acao="gra" title="Confirmar-Salvar" style="display: none;"><span class="fa fa-check"></span></a></li>                        <li><a href="#" id="btnVol" class="control-primary" data-acao="vol" title="Voltar-Cancelar" style="display: none;"><span class="fa fa-mail-reply"></span></a></li>                    </ul>                </div>                <div class="panel-body">                    <div id="divPadrao" class="row">                        <div class="col-md-12">                            <table id="t_dados" class="table table-striped table-bordered table-condensed">                            </table>                        </div>                    </div>                    <div id="divEdicao" class="row" style="display: none;">                        <h4 id="lblTitulo"></h4>                        <div class="col-md-12">                            <div class="form-group">                                <div id="container">                                    <div id="divImgUser"></div>                                    <a id="pickfiles" href="#" class="btn btn-primary">Importar Foto</a>                                    <span id="filelist">Não é possível fazer upload</span>                                    <button id="uploadfiles" class="btn btn-default" style="display: none;">Upload</button>                                </div>                            </div>                        </div>                        <div class="col-md-12">                            <div class="form-group">                                <label>Usuário</label>                                <input id="txtId" type="hidden"/>                                <input id="txtUser" type="text" class="form-control" maxlength="15" placeholder="Usuário">                            </div>                        </div>                        <div class="col-md-12">                            <div class="form-group">                                <label>Senha</label>                                <input id="txtSenha" type="text" class="form-control" maxlength="15" placeholder="Senha">                            </div>                        </div>                        <div class="col-md-12">                            <div class="form-group">                                <label>Nome</label>                                <input id="txtNome" type="text" class="form-control" maxlength="20" placeholder="Nome">                            </div>                        </div>                        <div class="col-md-12">                            <div class="form-group">                                <label>Sobrenome</label>                                <input id="txtSobrenome" type="text" class="form-control" maxlength="20" placeholder="sobrenome">                            </div>                        </div>                        <div class="col-md-12">                            <div class="form-group">                                <label>Email</label>                                <input id="txtEmail" type="text" class="form-control" maxlength="50" placeholder="Email">                            </div>                        </div>                        <div class="col-md-12">                            <div class="form-group">                                <label>CPF</label>                                <input id="txtCpf" onkeyup="validInput(this,'num');" type="number" class="form-control" maxlength="11" placeholder="12345678900">                            </div>                        </div>                        <div class="col-md-12">                            <div class="form-group">                                <label>Permissão</label>                                <select id="sel_contas" class="form-control" data-live-search="true"></select>                            </div>                        </div>                        <div class="col-md-12">                            <div class="form-group">                                <label>Status</label>                                <select id="sel_status" class="form-control" data-live-search="true">                                    <option value="1">Ativo</option>                                    <option value="0">Inativo</option>                                </select>                            </div>                        </div>                    </div>                </div>            </div>        </div>    </div></div><div class="modal" id="modal_small" tabindex="-1" role="dialog" aria-hidden="true">    <div class="modal-dialog modal-sm">        <div class="modal-content">            <div class="modal-header">                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>                <h4 class="modal-title" id="defModalHead">Confirmação</h4>            </div>            <div class="modal-body">                Você tem certeza que deseja remover esse usuário?            </div>            <div class="modal-footer">                <button type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</button>                <button id="btnRemConf" type="button" class="btn btn-primary" data-dismiss="modal">Sim</button>            </div>        </div>    </div></div>